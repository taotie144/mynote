## 零、三通道按像素分类

------

输出层三通道，分别代表眼球、视神经、背景的概率。激活函数softmax，每个像素的三个通道输出值之和恒为一。

训练集8000，验证集380，优化器Adam(lr=5e-5)，训练过程如下：

![train](<https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/1.png>)

![valid](<https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/2.png>)

![loss](<https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/3.png>)

这里使用了早停法，记录了epoch=291时的网络参数，可以看出epoch>291时已经开始过拟合了。

训练集：眼球94.18%，视神经96.46%，背景93.19%

验证集：眼球92.55%，视神经95.53%，背景91.27%

因为网络在较早期就出现了过拟合现象，说明网络的泛化能力不足，下一步要对数据集进行适当调整，比如验证集和测试集要分开，来提升网络的泛化能力。

## 一、调整数据集

------

重新对原始数据做数据增强，如下所示：

![augment](<https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/4.png>)

数据增强后419×24=10056，随机剔除56张图，剩余的10000张图里面8000张作为训练集，验证集和测试集各1000张。提高了验证集和测试集在总数上的比例，可以增强网络的泛化能力。

训练参数仍然是Adam(lr=5e-5)，结果如下：

![train](https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/5.png)

![valid](https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/6.png)

![loss](https://raw.githubusercontent.com/taotie144/ImgStore/master/temp5/7.png)

从损失函数曲线上可以看出，epoch=352时验证集上的损失值最小， 而epoch>352时再次出现过拟合的现象。与上次实验相比过拟合的现象有一定延后，但是仍然太早，说明训练的数据仍然有很多不足，比如原始数据太少或者增强的方法不合适，过拟合现象很难避免。在epoch=352时的训练结果为

训练集：眼球94.65%，视神经96.73%，背景93.73%，损失值0.0128

验证集：眼球93.28%，视神经95.92%，背景92.14%，损失值0.0210

测试集：眼球93.28%，视神经95.97%，背景92.16%，损失值0.0210

|        | 眼球 | 视神经 | 背景 | 损失值 |
| ------ | ---- | ------ | ---- | ------ |
| 训练集 |      |        |      |        |
| 验证集 |      |        |      |        |
| 测试集 |      |        |      |        |

